<!DOCTYPE html>
<html>
  <head>
    <meta content="text/html;charset=utf-8" http-equiv="Content-Type">
    <meta content="utf-8" http-equiv="encoding">

    <title>Evolution2020 - AlphaApp</title>
    
    <!-- Styling -->
    <link rel="stylesheet" type="text/css" href="./styles/custom.css">

    <!-- Load Modules -->
    <script src="./scripts/map.js"></script>
    <script src="./scripts/objects.js"></script>
    <script src="./scripts/characters.js"></script>
    <script src="./scripts/engine.js"></script>
  </head>
  <body>
    <script>
      // TODO: Firefox has a security flaw - https://www.w3.org/TR/CSP/ (reference to error)
      var map;
      var lead;
      var markers = [];
      var labels = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ';
      var labelIndex = 0;      
      var currentCoordinates = {lat: 33.678, lng: -116.243};
      var mouseClickStartStop = 1;
      var circle;

      // Engine
      function initMap() {
        // Load custom map
        maps.generateCustomMap();

        // Place Main Character
        var leadchar = characters.generateMainCharacter();

         google.maps.event.addListener(map, 'click', function (event) {
                mouseClickStartStop = mouseClickStartStop * (-1);
                //alert(mouseClickStartStop);
          });

         google.maps.event.addListener(map, 'mousemove', function (e) {
          if (mouseClickStartStop==-1){
            //alert("move now");
            leadchar.setPosition(e.latLng);
            currentCoordinates = {lat: leadchar.getPosition().lat(), lng: leadchar.getPosition().lng()};
            //alert(leadchar.getPosition().lat());
          }
         });
      }
  
      // Generate Random Objects
      var generateObjects = setInterval(myTimer, 3000);
      function myTimer() { objectGenerator.ObjMarkers(currentCoordinates); }

      // Removes all Random objects from map at one go-- every 'n' milli seconds
      var removeObjects = setInterval(myTimerDel, 50000);
      function myTimerDel() { objectGenerator.deleteMarkers(); }

    </script>
    <script src="./scripts/debug.js"></script>
    <div id="map"></div>
    <script async defer
    src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCptCv0cVk7cSFAaTn-kYpxEShFD6OVjSk&callback=initMap">
    </script>
  </body>
</html>
